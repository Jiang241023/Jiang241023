I1204 08:23:42.037774 18500 datasets.py:22] Preparing dataset idrid...
Found 588 files belonging to 2 classes.
no of batches is 29
Found 103 files belonging to 2 classes.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:42.473369 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.481616 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.490190 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:42.496629 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1204 08:23:42.579561 18500 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:42.615035 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.623814 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.634382 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:42.643077 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:42.660150 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.668550 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.677536 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:42.685013 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1204 08:23:42.743296 18500 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:42.765254 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.772844 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.781374 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:42.787267 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:42.840316 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.848367 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.857025 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
W1204 08:23:42.867537 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
W1204 08:23:42.879593 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:42.888567 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
W1204 08:23:42.909454 18500 pfor.py:1082] Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:42.960609 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.972126 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:42.984054 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:42.992512 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1204 08:23:43.077539 18500 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:43.112536 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.123291 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.133965 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:43.142593 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:43.163505 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.173034 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.183471 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:43.191020 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1204 08:23:43.246531 18500 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:43.269680 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.279566 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.290655 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:43.299538 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1204 08:23:43.356013 18500 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.364879 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1204 08:23:43.378489 18500 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
W1204 08:23:43.386897 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
W1204 08:23:43.402554 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1204 08:23:43.412626 18500 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
W1204 08:23:43.435596 18500 pfor.py:1082] Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
W1204 08:23:44.080872 18500 mobilenet.py:241] `input_shape` is undefined or non-square, or `rows` is not in [128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
(None, 256, 256, 3)
(None, 8, 8, 512)
----------------------------------------------------------------------------------------
Starting training mobilenet_like
Model: "mobilenet_like"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_2 (InputLayer)        [(None, 256, 256, 3)]     0

 mobilenet_1.00_224 (Functio  (None, 8, 8, 1024)       3228864
 nal)

 depthwise_conv2d_6 (Depthwi  (None, 8, 8, 1024)       9216
 seConv2D)

 batch_normalization_12 (Bat  (None, 8, 8, 1024)       4096
 chNormalization)

 re_lu_12 (ReLU)             (None, 8, 8, 1024)        0

 conv2d_6 (Conv2D)           (None, 8, 8, 63)          64512

 batch_normalization_13 (Bat  (None, 8, 8, 63)         252
 chNormalization)

 re_lu_13 (ReLU)             (None, 8, 8, 63)          0

 global_average_pooling2d (G  (None, 63)               0
 lobalAveragePooling2D)

 dense (Dense)               (None, 150)               9600

 dropout (Dropout)           (None, 150)               0

 dense_1 (Dense)             (None, 1)                 151

=================================================================
Total params: 3,316,691
Trainable params: 85,653
Non-trainable params: 3,231,038
_________________________________________________________________
Number of batches in validation dataset: 8
Validation batch shape: (16, 256, 256, 3), Label shape: (16,)
input_2 True
mobilenet_1.00_224 False
depthwise_conv2d_6 True
batch_normalization_12 True
re_lu_12 True
conv2d_6 True
batch_normalization_13 True
re_lu_13 True
global_average_pooling2d True
dense True
dropout True
dense_1 True
I1204 08:23:52.916952 18500 train.py:86] epochs: 1.0, Loss: 0.6958982944488525, Accuracy: 53.18681716918945, Test Loss: 0.688143789768219, Test Accuracy: 78.63247680664062
I1204 08:23:53.092246 18500 train.py:86] epochs: 2.0, Loss: 0.5967691540718079, Accuracy: 73.4065933227539, Test Loss: 0.6821117997169495, Test Accuracy: 75.21367645263672
I1204 08:23:53.268750 18500 train.py:86] epochs: 3.0, Loss: 0.5324247479438782, Accuracy: 79.34066009521484, Test Loss: 0.6745860576629639, Test Accuracy: 74.35897827148438
I1204 08:23:53.448634 18500 train.py:86] epochs: 4.0, Loss: 0.48043856024742126, Accuracy: 83.51648712158203, Test Loss: 0.6636554002761841, Test Accuracy: 76.92308044433594
I1204 08:23:53.620983 18500 train.py:86] epochs: 5.0, Loss: 0.4530767798423767, Accuracy: 81.31867980957031, Test Loss: 0.6488842368125916, Test Accuracy: 76.92308044433594
I1204 08:23:53.795402 18500 train.py:86] epochs: 6.0, Loss: 0.42569008469581604, Accuracy: 80.87911987304688, Test Loss: 0.6326120495796204, Test Accuracy: 80.34188079833984
I1204 08:23:53.974864 18500 train.py:86] epochs: 7.0, Loss: 0.3769879639148712, Accuracy: 84.48275756835938, Test Loss: 0.609645664691925, Test Accuracy: 84.61538696289062
I1204 08:23:54.146244 18500 train.py:86] epochs: 8.0, Loss: 0.3681338131427765, Accuracy: 84.61538696289062, Test Loss: 0.5857366323471069, Test Accuracy: 84.61538696289062
I1204 08:23:54.324642 18500 train.py:86] epochs: 9.0, Loss: 0.3487611413002014, Accuracy: 87.4439468383789, Test Loss: 0.5555001497268677, Test Accuracy: 84.61538696289062
I1204 08:23:54.494731 18500 train.py:86] epochs: 10.0, Loss: 0.30690884590148926, Accuracy: 87.9120864868164, Test Loss: 0.5224974751472473, Test Accuracy: 86.32478332519531
I1204 08:23:54.496910 18500 train.py:113] Finished training after 10.0 epochs.
I1204 08:23:54.793248 18500 train.py:86] epochs: 1.0, Loss: 0.28983157873153687, Accuracy: 88.57142639160156, Test Loss: 0.4854479432106018, Test Accuracy: 86.32478332519531
I1204 08:23:54.964215 18500 train.py:86] epochs: 2.0, Loss: 0.28606945276260376, Accuracy: 88.35164642333984, Test Loss: 0.4515545070171356, Test Accuracy: 86.32478332519531
I1204 08:23:55.136959 18500 train.py:86] epochs: 3.0, Loss: 0.2556323707103729, Accuracy: 90.989013671875, Test Loss: 0.4157241880893707, Test Accuracy: 88.03418731689453
I1204 08:23:55.310642 18500 train.py:86] epochs: 4.0, Loss: 0.24175186455249786, Accuracy: 92.0879135131836, Test Loss: 0.37686243653297424, Test Accuracy: 87.17948913574219
I1204 08:23:55.489565 18500 train.py:86] epochs: 5.0, Loss: 0.21214307844638824, Accuracy: 93.4065933227539, Test Loss: 0.34705650806427, Test Accuracy: 86.32478332519531
I1204 08:23:55.659374 18500 train.py:86] epochs: 6.0, Loss: 0.21273957192897797, Accuracy: 92.74725341796875, Test Loss: 0.32345423102378845, Test Accuracy: 88.03418731689453
I1204 08:23:55.835902 18500 train.py:86] epochs: 7.0, Loss: 0.1996982991695404, Accuracy: 93.96551513671875, Test Loss: 0.3023117780685425, Test Accuracy: 87.17948913574219
I1204 08:23:56.005699 18500 train.py:86] epochs: 8.0, Loss: 0.1749245822429657, Accuracy: 95.73991394042969, Test Loss: 0.2863961458206177, Test Accuracy: 86.32478332519531
I1204 08:23:56.183229 18500 train.py:86] epochs: 9.0, Loss: 0.16264332830905914, Accuracy: 96.55171966552734, Test Loss: 0.2739117741584778, Test Accuracy: 86.32478332519531
I1204 08:23:56.359226 18500 train.py:86] epochs: 10.0, Loss: 0.1524640917778015, Accuracy: 97.085205078125, Test Loss: 0.2694850564002991, Test Accuracy: 85.47008514404297
I1204 08:23:56.361940 18500 train.py:113] Finished training after 10.0 epochs.
Training checkpoint path for mobilenet_like: F:\DL_lab\experiments\run_2024-12-04T08-23-41-387878_mobilenet_like\ckpts
Training completed for mobilenet_like
----------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------
Starting training vgg_like
Model: "vgg_like"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_4 (InputLayer)        [(None, 256, 256, 3)]     0

 vgg16 (Functional)          (None, 8, 8, 512)         14714688

 conv2d_11 (Conv2D)          (None, 8, 8, 83)          382547

 max_pooling2d_4 (MaxPooling  (None, 4, 4, 83)         0
 2D)

 conv2d_12 (Conv2D)          (None, 4, 4, 83)          62084

 max_pooling2d_5 (MaxPooling  (None, 2, 2, 83)         0
 2D)

 global_average_pooling2d_1   (None, 83)               0
 (GlobalAveragePooling2D)

 dense_2 (Dense)             (None, 113)               9492

 leaky_re_lu (LeakyReLU)     (None, 113)               0

 dropout_1 (Dropout)         (None, 113)               0

 dense_3 (Dense)             (None, 1)                 114

=================================================================
Total params: 15,168,925
Trainable params: 454,237
Non-trainable params: 14,714,688
_________________________________________________________________
Number of batches in validation dataset: 8
Validation batch shape: (16, 256, 256, 3), Label shape: (16,)
input_4 True
vgg16 False
conv2d_11 True
max_pooling2d_4 True
conv2d_12 True
max_pooling2d_5 True
global_average_pooling2d_1 True
dense_2 True
leaky_re_lu True
dropout_1 True
dense_3 True
I1204 08:24:00.001369 18500 train.py:86] epochs: 1.0, Loss: 0.6442676782608032, Accuracy: 65.05494689941406, Test Loss: 0.573802649974823, Test Accuracy: 79.4871826171875
I1204 08:24:00.973371 18500 train.py:86] epochs: 2.0, Loss: 0.5338038802146912, Accuracy: 77.58621215820312, Test Loss: 0.4710448682308197, Test Accuracy: 82.05128479003906
