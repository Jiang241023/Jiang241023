I1129 14:26:38.286099  7508 datasets.py:22] Preparing dataset idrid...
Found 588 files belonging to 2 classes.
no of batches is 29
Found 103 files belonging to 2 classes.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:38.733815  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:38.743069  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:38.751294  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:38.758456  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 14:26:38.840732  7508 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:38.875522  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:38.882277  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:38.890358  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:38.897538  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:38.916307  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:38.923842  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:38.931594  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:38.938387  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 14:26:38.993602  7508 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.014589  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.023322  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.032864  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.039537  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.090333  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.098560  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.106791  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
W1129 14:26:39.113847  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
W1129 14:26:39.127133  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.135653  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
W1129 14:26:39.156713  7508 pfor.py:1082] Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.207609  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.216841  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.228537  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.237201  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 14:26:39.435011  7508 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.474105  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.483448  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.493937  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.503965  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.522943  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.532678  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.543087  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.553954  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 14:26:39.610298  7508 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.631584  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.639612  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.649707  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.661460  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 14:26:39.715088  7508 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.725145  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 14:26:39.735066  7508 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
W1129 14:26:39.743783  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
W1129 14:26:39.759358  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 14:26:39.771041  7508 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
W1129 14:26:39.794137  7508 pfor.py:1082] Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
W1129 14:26:40.422070  7508 mobilenet.py:241] `input_shape` is undefined or non-square, or `rows` is not in [128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
(None, 256, 256, 3)
(None, 8, 8, 512)
Model: "mobile_like"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_2 (InputLayer)        [(None, 256, 256, 3)]     0

 mobilenet_1.00_224 (Functio  (None, 8, 8, 1024)       3228864
 nal)

 depthwise_conv2d (Depthwise  (None, 8, 8, 1024)       9216
 Conv2D)

 batch_normalization (BatchN  (None, 8, 8, 1024)       4096
 ormalization)

 re_lu (ReLU)                (None, 8, 8, 1024)        0

 conv2d (Conv2D)             (None, 8, 8, 4)           4096

 batch_normalization_1 (Batc  (None, 8, 8, 4)          16
 hNormalization)

 re_lu_1 (ReLU)              (None, 8, 8, 4)           0

 global_average_pooling2d (G  (None, 4)                0
 lobalAveragePooling2D)

 dense (Dense)               (None, 64)                320

 dropout (Dropout)           (None, 64)                0

 dense_1 (Dense)             (None, 1)                 65

=================================================================
Total params: 3,246,673
Trainable params: 15,753
Non-trainable params: 3,230,920
_________________________________________________________________
Model: "vgg_like"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_4 (InputLayer)        [(None, 256, 256, 3)]     0

 vgg16 (Functional)          (None, 8, 8, 512)         14714688

 conv2d_1 (Conv2D)           (None, 8, 8, 4)           18436

 max_pooling2d (MaxPooling2D  (None, 4, 4, 4)          0
 )

 conv2d_2 (Conv2D)           (None, 4, 4, 4)           148

 max_pooling2d_1 (MaxPooling  (None, 2, 2, 4)          0
 2D)

 global_average_pooling2d_1   (None, 4)                0
 (GlobalAveragePooling2D)

 dense_2 (Dense)             (None, 128)               640

 leaky_re_lu (LeakyReLU)     (None, 128)               0

 dropout_1 (Dropout)         (None, 128)               0

 dense_3 (Dense)             (None, 1)                 129

=================================================================
Total params: 14,734,041
Trainable params: 19,353
Non-trainable params: 14,714,688
_________________________________________________________________
--------------------------------------------------------------------------------
Number of batches in validation dataset: 8
Validation batch shape: (16, 256, 256, 3), Label shape: (16,)
input_2 True
mobilenet_1.00_224 False
depthwise_conv2d True
batch_normalization True
re_lu True
conv2d True
batch_normalization_1 True
re_lu_1 True
global_average_pooling2d True
dense True
dropout True
dense_1 True
I1129 14:26:46.565504  7508 train.py:86] epochs: 5.0, Loss: 0.6683796048164368, Accuracy: 62.74080276489258, Test Loss: 0.6887350082397461, Test Accuracy: 58.974361419677734
I1129 14:26:47.268365  7508 train.py:86] epochs: 10.0, Loss: 0.6093080639839172, Accuracy: 80.14122009277344, Test Loss: 0.6640998721122742, Test Accuracy: 67.52136993408203
I1129 14:26:47.976134  7508 train.py:86] epochs: 15.0, Loss: 0.5473983287811279, Accuracy: 86.15384674072266, Test Loss: 0.602281391620636, Test Accuracy: 76.92308044433594
I1129 14:26:48.683536  7508 train.py:86] epochs: 20.0, Loss: 0.48040956258773804, Accuracy: 90.3677749633789, Test Loss: 0.5261973142623901, Test Accuracy: 81.19657897949219
I1129 14:26:49.388177  7508 train.py:86] epochs: 25.0, Loss: 0.41936194896698, Accuracy: 92.96703338623047, Test Loss: 0.4706611931324005, Test Accuracy: 84.61538696289062
I1129 14:26:50.097927  7508 train.py:86] epochs: 30.0, Loss: 0.3552834689617157, Accuracy: 95.0769271850586, Test Loss: 0.4338255822658539, Test Accuracy: 83.76068115234375
I1129 14:26:50.100511  7508 train.py:113] Finished training after 30.0 steps.
Training checkpoint path for mobilenet_like: F:\dl lab\dl-lab-24w-team04-feature\experiments\run_2024-11-29T14-26-37-661761\ckpts
Number of batches in validation dataset: 8
Validation batch shape: (16, 256, 256, 3), Label shape: (16,)
--------------------------------------------------------------------------------
input_4 True
vgg16 False
conv2d_1 True
max_pooling2d True
conv2d_2 True
max_pooling2d_1 True
global_average_pooling2d_1 True
dense_2 True
leaky_re_lu True
dropout_1 True
dense_3 True
I1129 14:26:52.236103  7508 train.py:86] epochs: 5.0, Loss: 0.30687981843948364, Accuracy: 96.61538696289062, Test Loss: 0.4087003171443939, Test Accuracy: 85.47008514404297
I1129 14:26:52.943983  7508 train.py:86] epochs: 10.0, Loss: 0.2634449005126953, Accuracy: 97.4945068359375, Test Loss: 0.3839104473590851, Test Accuracy: 85.47008514404297
I1129 14:26:53.660604  7508 train.py:86] epochs: 15.0, Loss: 0.21894438564777374, Accuracy: 98.54944610595703, Test Loss: 0.369376003742218, Test Accuracy: 87.17948913574219
I1129 14:26:54.375352  7508 train.py:86] epochs: 20.0, Loss: 0.1851106733083725, Accuracy: 99.20879364013672, Test Loss: 0.3589535653591156, Test Accuracy: 85.47008514404297
I1129 14:26:55.097072  7508 train.py:86] epochs: 25.0, Loss: 0.1574411392211914, Accuracy: 99.56044006347656, Test Loss: 0.3516243100166321, Test Accuracy: 85.47008514404297
I1129 14:26:55.809303  7508 train.py:86] epochs: 30.0, Loss: 0.12566976249217987, Accuracy: 99.86865234375, Test Loss: 0.347873330116272, Test Accuracy: 83.76068115234375
I1129 14:26:55.811851  7508 train.py:113] Finished training after 30.0 steps.
Training checkpoint path for vgg_like: F:\dl lab\dl-lab-24w-team04-feature\experiments\run_2024-11-29T14-26-37-661761\ckpts
--------------------------------------------------------------------------------
