I1129 18:06:51.015505 20788 datasets.py:22] Preparing dataset idrid...
Found 588 files belonging to 2 classes.
no of batches is 29
Found 103 files belonging to 2 classes.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:51.446992 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.456549 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.465277 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:51.472514 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 18:06:51.555021 20788 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:51.589494 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.596594 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.605180 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:51.613107 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:51.630802 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.638754 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.647305 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:51.654970 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 18:06:51.708700 20788 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:51.732629 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.740769 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.750143 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:51.757200 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:51.808470 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.816638 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:51.825128 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
W1129 18:06:51.831183 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
W1129 18:06:51.846551 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:51.854944 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
W1129 18:06:51.876263 20788 pfor.py:1082] Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:52.037303 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.046552 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.058232 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:52.067947 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 18:06:52.149227 20788 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:52.184570 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.193901 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.204413 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:52.212247 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:52.230172 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.240223 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.250133 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:52.258136 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
W1129 18:06:52.313935 20788 pfor.py:1082] Using a while_loop for converting ImageProjectiveTransformV3 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:52.333967 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.343527 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.353830 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:52.362366 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
W1129 18:06:52.418996 20788 pfor.py:1082] Using a while_loop for converting RngReadAndSkip cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.428100 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting Bitcast cause there is no registered converter for this op.
W1129 18:06:52.438446 20788 pfor.py:1082] Using a while_loop for converting Bitcast cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
W1129 18:06:52.446652 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformFullIntV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
W1129 18:06:52.462660 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomGetKeyCounter cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
W1129 18:06:52.472560 20788 pfor.py:1082] Using a while_loop for converting StatelessRandomUniformV2 cause there is no registered converter for this op.
WARNING:tensorflow:Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
W1129 18:06:52.498569 20788 pfor.py:1082] Using a while_loop for converting AdjustContrastv2 cause Input "contrast_factor" of op 'AdjustContrastv2' expected to be loop invariant.
WARNING:tensorflow:`input_shape` is undefined or non-square, or `rows` is not in [128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
W1129 18:06:53.129030 20788 mobilenet.py:241] `input_shape` is undefined or non-square, or `rows` is not in [128, 160, 192, 224]. Weights for input shape (224, 224) will be loaded as the default.
(None, 256, 256, 3)
(None, 8, 8, 512)
Model: "mobile_like"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_2 (InputLayer)        [(None, 256, 256, 3)]     0

 mobilenet_1.00_224 (Functio  (None, 8, 8, 1024)       3228864
 nal)

 depthwise_conv2d (Depthwise  (None, 8, 8, 1024)       9216
 Conv2D)

 batch_normalization (BatchN  (None, 8, 8, 1024)       4096
 ormalization)

 re_lu (ReLU)                (None, 8, 8, 1024)        0

 conv2d (Conv2D)             (None, 8, 8, 5)           5120

 batch_normalization_1 (Batc  (None, 8, 8, 5)          20
 hNormalization)

 re_lu_1 (ReLU)              (None, 8, 8, 5)           0

 global_average_pooling2d (G  (None, 5)                0
 lobalAveragePooling2D)

 dense (Dense)               (None, 128)               768

 dropout (Dropout)           (None, 128)               0

 dense_1 (Dense)             (None, 1)                 129

=================================================================
Total params: 3,248,213
Trainable params: 17,291
Non-trainable params: 3,230,922
_________________________________________________________________
Model: "vgg_like"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_4 (InputLayer)        [(None, 256, 256, 3)]     0

 vgg16 (Functional)          (None, 8, 8, 512)         14714688

 conv2d_1 (Conv2D)           (None, 8, 8, 5)           23045

 max_pooling2d (MaxPooling2D  (None, 4, 4, 5)          0
 )

 conv2d_2 (Conv2D)           (None, 4, 4, 5)           230

 max_pooling2d_1 (MaxPooling  (None, 2, 2, 5)          0
 2D)

 global_average_pooling2d_1   (None, 5)                0
 (GlobalAveragePooling2D)

 dense_2 (Dense)             (None, 128)               768

 leaky_re_lu (LeakyReLU)     (None, 128)               0

 dropout_1 (Dropout)         (None, 128)               0

 dense_3 (Dense)             (None, 1)                 129

=================================================================
Total params: 14,738,860
Trainable params: 24,172
Non-trainable params: 14,714,688
_________________________________________________________________
----------------------------------------------------------------------------------------
Starting training mobilenet_like
Number of batches in validation dataset: 8
Validation batch shape: (16, 256, 256, 3), Label shape: (16,)
input_2 True
mobilenet_1.00_224 False
depthwise_conv2d True
batch_normalization True
re_lu True
conv2d True
batch_normalization_1 True
re_lu_1 True
global_average_pooling2d True
dense True
dropout True
dense_1 True
I1129 18:06:58.184462 20788 train.py:86] epochs: 1.0, Loss: 0.6807935833930969, Accuracy: 52.52747344970703, Test Loss: 0.6898570656776428, Test Accuracy: 45.29914474487305
I1129 18:06:58.357018 20788 train.py:86] epochs: 2.0, Loss: 0.6625364422798157, Accuracy: 55.38461685180664, Test Loss: 0.6861111521720886, Test Accuracy: 69.23077392578125
I1129 18:06:58.530546 20788 train.py:86] epochs: 3.0, Loss: 0.6398708820343018, Accuracy: 59.78022384643555, Test Loss: 0.6818338632583618, Test Accuracy: 78.63247680664062
I1129 18:06:58.702105 20788 train.py:86] epochs: 4.0, Loss: 0.6218984127044678, Accuracy: 67.03296661376953, Test Loss: 0.6769524812698364, Test Accuracy: 82.05128479003906
I1129 18:06:58.875952 20788 train.py:86] epochs: 5.0, Loss: 0.6168949604034424, Accuracy: 65.27472686767578, Test Loss: 0.6710277795791626, Test Accuracy: 86.32478332519531
I1129 18:06:59.047660 20788 train.py:86] epochs: 6.0, Loss: 0.6022358536720276, Accuracy: 71.86813354492188, Test Loss: 0.6624737977981567, Test Accuracy: 84.61538696289062
I1129 18:06:59.222962 20788 train.py:86] epochs: 7.0, Loss: 0.5770107507705688, Accuracy: 76.04396057128906, Test Loss: 0.6522448062896729, Test Accuracy: 84.61538696289062
I1129 18:06:59.394071 20788 train.py:86] epochs: 8.0, Loss: 0.5616883635520935, Accuracy: 80.43955993652344, Test Loss: 0.6407756209373474, Test Accuracy: 85.47008514404297
I1129 18:06:59.396395 20788 train.py:113] Finished training after 8.0 steps.
I1129 18:06:59.694194 20788 train.py:86] epochs: 1.0, Loss: 0.5462581515312195, Accuracy: 80.87911987304688, Test Loss: 0.6269301176071167, Test Accuracy: 85.47008514404297
I1129 18:06:59.867274 20788 train.py:86] epochs: 2.0, Loss: 0.5307657122612, Accuracy: 82.63736724853516, Test Loss: 0.6111940145492554, Test Accuracy: 85.47008514404297
I1129 18:07:00.043923 20788 train.py:86] epochs: 3.0, Loss: 0.517265260219574, Accuracy: 83.95604705810547, Test Loss: 0.5953664183616638, Test Accuracy: 86.32478332519531
I1129 18:07:00.215400 20788 train.py:86] epochs: 4.0, Loss: 0.5127081274986267, Accuracy: 84.17582702636719, Test Loss: 0.5798203349113464, Test Accuracy: 86.32478332519531
I1129 18:07:00.390743 20788 train.py:86] epochs: 5.0, Loss: 0.4895436465740204, Accuracy: 86.5934066772461, Test Loss: 0.5605283975601196, Test Accuracy: 86.32478332519531
I1129 18:07:00.561966 20788 train.py:86] epochs: 6.0, Loss: 0.46663448214530945, Accuracy: 87.9120864868164, Test Loss: 0.5415474772453308, Test Accuracy: 86.32478332519531
I1129 18:07:00.735120 20788 train.py:86] epochs: 7.0, Loss: 0.4449678361415863, Accuracy: 89.23076629638672, Test Loss: 0.5221722722053528, Test Accuracy: 85.47008514404297
I1129 18:07:00.907416 20788 train.py:86] epochs: 8.0, Loss: 0.44721612334251404, Accuracy: 86.81318664550781, Test Loss: 0.5052786469459534, Test Accuracy: 85.47008514404297
I1129 18:07:00.910037 20788 train.py:113] Finished training after 8.0 steps.
Training checkpoint path for mobilenet_like: F:\dl lab\dl-lab-24w-team04-feature\experiments\run_2024-11-29T18-06-50-456158_mobilenet_like\ckpts
Training completed for mobilenet_like
----------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------
Starting training vgg_like
Number of batches in validation dataset: 8
Validation batch shape: (16, 256, 256, 3), Label shape: (16,)
input_4 True
vgg16 False
conv2d_1 True
max_pooling2d True
conv2d_2 True
max_pooling2d_1 True
global_average_pooling2d_1 True
dense_2 True
leaky_re_lu True
dropout_1 True
dense_3 True
I1129 18:07:04.477268 20788 train.py:86] epochs: 1.0, Loss: 0.696373462677002, Accuracy: 48.35165023803711, Test Loss: 0.6903936862945557, Test Accuracy: 59.829063415527344
I1129 18:07:05.317288 20788 train.py:86] epochs: 2.0, Loss: 0.6908203363418579, Accuracy: 54.06593704223633, Test Loss: 0.6846945881843567, Test Accuracy: 82.05128479003906
I1129 18:07:06.157976 20788 train.py:86] epochs: 3.0, Loss: 0.6824705004692078, Accuracy: 59.340660095214844, Test Loss: 0.676211953163147, Test Accuracy: 84.61538696289062
I1129 18:07:07.009153 20788 train.py:86] epochs: 4.0, Loss: 0.671201229095459, Accuracy: 62.93103790283203, Test Loss: 0.6619320511817932, Test Accuracy: 77.77777862548828
I1129 18:07:07.836097 20788 train.py:86] epochs: 5.0, Loss: 0.6542028188705444, Accuracy: 68.83407592773438, Test Loss: 0.6335651278495789, Test Accuracy: 84.61538696289062
I1129 18:07:08.674586 20788 train.py:86] epochs: 6.0, Loss: 0.6290450096130371, Accuracy: 69.23077392578125, Test Loss: 0.591044545173645, Test Accuracy: 82.9059829711914
I1129 18:07:09.526633 20788 train.py:86] epochs: 7.0, Loss: 0.5972657203674316, Accuracy: 76.93965148925781, Test Loss: 0.5377455353736877, Test Accuracy: 88.03418731689453
I1129 18:07:10.354646 20788 train.py:86] epochs: 8.0, Loss: 0.5638287663459778, Accuracy: 77.80268859863281, Test Loss: 0.487504243850708, Test Accuracy: 87.17948913574219
I1129 18:07:10.357081 20788 train.py:113] Finished training after 8.0 steps.
I1129 18:07:11.324564 20788 train.py:86] epochs: 1.0, Loss: 0.5146785974502563, Accuracy: 79.56044006347656, Test Loss: 0.4353393018245697, Test Accuracy: 89.74359130859375
I1129 18:07:12.178183 20788 train.py:86] epochs: 2.0, Loss: 0.4871419668197632, Accuracy: 79.31034851074219, Test Loss: 0.39563578367233276, Test Accuracy: 88.03418731689453
I1129 18:07:13.004409 20788 train.py:86] epochs: 3.0, Loss: 0.4489316940307617, Accuracy: 81.16592407226562, Test Loss: 0.3563333749771118, Test Accuracy: 88.03418731689453
I1129 18:07:13.843684 20788 train.py:86] epochs: 4.0, Loss: 0.43801045417785645, Accuracy: 82.41758728027344, Test Loss: 0.3320772051811218, Test Accuracy: 88.8888931274414
I1129 18:07:14.695044 20788 train.py:86] epochs: 5.0, Loss: 0.41588732600212097, Accuracy: 84.05171966552734, Test Loss: 0.33931389451026917, Test Accuracy: 87.17948913574219
I1129 18:07:15.523834 20788 train.py:86] epochs: 6.0, Loss: 0.40249791741371155, Accuracy: 82.95964050292969, Test Loss: 0.3012450933456421, Test Accuracy: 90.5982894897461
I1129 18:07:16.374092 20788 train.py:86] epochs: 7.0, Loss: 0.39551398158073425, Accuracy: 84.48275756835938, Test Loss: 0.2785297632217407, Test Accuracy: 94.01709747314453
I1129 18:07:17.214848 20788 train.py:86] epochs: 8.0, Loss: 0.36850470304489136, Accuracy: 84.83516693115234, Test Loss: 0.2681780159473419, Test Accuracy: 88.8888931274414
I1129 18:07:17.216542 20788 train.py:113] Finished training after 8.0 steps.
Training checkpoint path for vgg_like: F:\dl lab\dl-lab-24w-team04-feature\experiments\run_2024-11-29T18-06-50-457157_vgg_like\ckpts
Training completed for vgg_like
----------------------------------------------------------------------------------------
